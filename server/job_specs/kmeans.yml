---

name: kmeans

description: "Calculate k mean values for a set of n-dimensional data points."

task:
    name: kmeans
    mode: r

    script: >
        @include(kmeans.r)

    inputs:
      - name: input_path
        type: string
        format: text
      - name: has_header
        type: boolean
        format: boolean
      - name: num_clusters
        type: number
        format: number

    outputs:
      - name: centers
        type: table
        format: r.dataframe
        target: memory
      - name: clusters
        type: table
        format: r.dataframe
        target: memory

# Inputs are requested from the user
inputs:
  # Note: if there is no default, the parameter is required
  - key: input_path
    name: "Input Data"
    description: "A list of points, all with the same number of dimensions."
    type: item
    subtype: csv
  - key: has_header
    name: "Header in Data"
    description: "If set, skip the first line of the input file."
    type: boolean
    default: true
    format: json
  - key: num_clusters
    name: "Num. Clusters"
    description: "The number (k) of clusters to calculate means for"
    type: integer
    default: 5
    format: number

# Parameters are required by the rest endpoint, but not by the task inputs
parameters:
  - key: targetFolderId
    name: "Target Folder"
    type: folder

# See girderOutputSpec for details.
outputs: 
  - key: centers
    parentType: "folder"
    parent: "parameter:targetFolderId"
    name: "centers.csv"
    dataType: "table"
    dataFormat: "csv"
  - key: clusters
    parentType: "folder"
    parent: "parameter:targetFolderId"
    name: "clusters.csv"
    dataType: "table"
    dataFormat: "csv"
